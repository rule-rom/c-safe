# Intent-Garden (S-OAK) Core

> **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ C/C++ –∫–æ–¥–∞, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –ò–ò.**
>
> –ú—ã –Ω–µ –≤–µ—Ä–∏–º –≤ ¬´–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —è–∑—ã–∫–∏¬ª. –ú—ã –≤–µ—Ä–∏–º –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è.

## üìñ –û –ü—Ä–æ–µ–∫—Ç–µ

**Garden-Core** ‚Äî —ç—Ç–æ Clojure-–¥–≤–∏–∂–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –∞—É–¥–∏—Ä—É–µ—Ç –ò–ò-–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π C/C++ –∫–æ–¥ —á–µ—Ä–µ–∑ Clang AST –∏ EDN-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã. –≠—Ç–æ ¬´–ø–æ—Å–ª–µ–¥–Ω—è—è –º–∏–ª—è¬ª –º–µ–∂–¥—É —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–≤–æ–¥–æ–º –ò–ò –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ–¥–∞.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

> **–ú—ã –Ω–µ –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏ –ò–ò. –ú—ã —Å–æ–∑–¥–∞–µ–º —Å—Ä–µ–¥—É, –≥–¥–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –∫–æ–¥ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ —Å—Ç–∞–¥–∏—é —Å–±–æ—Ä–∫–∏.**

–î–≤–∏–∂–æ–∫ –∏—Å–∫–ª—é—á–∞–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏ –∑–∞ —Å—á–µ—Ç –∂–µ—Å—Ç–∫–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç—Ä—É–¥–∞:

1. **Intent Injection** ‚Äî –ò–ò-–∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –∏–∑ `rulerom/registry`
2. **Garden-Tagging** ‚Äî –ò–ò –ø–∏—à–µ—Ç C-–∫–æ–¥ –∏ —Ä–∞–∑–º–µ—á–∞–µ—Ç –µ–≥–æ —Ç–µ–≥–∞–º–∏ `[[garden:intent(...)]]`
3. **AST Enforcement** ‚Äî –î–≤–∏–∂–æ–∫ –ø–∞—Ä—Å–∏—Ç Clang JSON AST –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º
4. **Semantic Echo** ‚Äî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Markdown-–æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ–ª–æ–≤–µ–∫–æ–º

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| **Clojure / Babashka** | –ë—ã—Å—Ç—Ä–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ JVM-–æ–≤–µ—Ä—Ö–µ–¥–∞ |
| **Clang LibTooling** | –ü–∞—Ä—Å–∏–Ω–≥ `-ast-dump=json` –¥–ª—è —á–µ—Å—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞ |
| **EDN** | –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤, –ø–æ–Ω—è—Ç–Ω—ã–π —á–µ–ª–æ–≤–µ–∫—É –∏ –º–∞—à–∏–Ω–µ |

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –¶–∏–∫–ª ¬´–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ø–∫–æ—Ä—è¬ª

```mermaid
graph TD
    A["<b>1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</b><br/>–í–≤–æ–¥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ / –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"] --> B{AI Scan}
    B -->|–ü–æ–∏—Å–∫| C["<b>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Rule-Rom</b>"]
    B -->|–ì–µ–Ω–µ—Ä–∞—Ü–∏—è| D["<b>–ß–µ—Ä–Ω–æ–≤–∏–∫ Intent</b>"]

    C & D --> E["<b>2. –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</b><br/>Lisp/EDN –ö–æ–Ω—Ç—Ä–∞–∫—Ç"]
    E --> F["<i>Semantic Echo</i><br/>–ê–≤—Ç–æ-Markdown –∞—É–¥–∏—Ç"]
    F -->|–ü—Ä–æ–≤–µ—Ä–∫–∞| G(("–ê–ø–ø—Ä—É–≤ —á–µ–ª–æ–≤–µ–∫–∞"))
    G -->|–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ| E

    G -->|–û–¥–æ–±—Ä–µ–Ω–æ| H["<b>3. –ò–Ω—ä–µ–∫—Ü–∏—è –≤ –ø—Ä–æ–º–ø—Ç</b><br/>–ö–æ–Ω—Ç—Ä–∞–∫—Ç + –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è"]
    H --> I["<b>4. –ö–æ–¥ + –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</b><br/>C/C++ –ö–æ–¥ + garden-tags"]

    I --> J["<b>5. AST Enforcement</b><br/>Clang JSON AST + Babashka"]
    J --> K{–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è}
    K -->|–ù–∞—Ä—É—à–µ–Ω–∏–µ| L["<b>–°–±–æ—Ä–∫–∞ —É–ø–∞–ª–∞</b><br/>–ü–æ–≤—Ç–æ—Ä"]
    L --> H

    K -->|–£—Å–ø–µ—Ö| M["<b>6. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</b><br/>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"]
    M --> N["–ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–¥"]

    style A fill:#e1f5fe,stroke:#01579b
    style E fill:#f3e5f5,stroke:#4a148c
    style I fill:#fff3e0,stroke:#e65100
    style J fill:#e8f5e9,stroke:#1b5e20
    style M fill:#dcedc8,stroke:#33691e
    style L fill:#ffebee,stroke:#b71c1c
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –û–∫—Ä—É–∂–µ–Ω–∏—è (Windows / Scoop)

```powershell
scoop install babashka llvm
```

### 2. –ó–∞–ø—É—Å–∫ –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ –ê—É–¥–∏—Ç–∞

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –≤–∞—Å –µ—Å—Ç—å —Ñ–∞–π–ª `test.c` —Å —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏:

```c
// [[garden:intent(safe-free)]]
free(p);
p = NULL;
// [[/garden:intent]]
```

**–®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º AST**

```powershell
clang -Xclang -ast-dump=json -fsyntax-only test.c > ast.json
```

**–®–∞–≥ 2: –ó–∞–ø—É—Å–∫–∞–µ–º Enforcer**

```powershell
bb -m garden.enforcer ast.json
```

### 3. –ü—Ä–∏–º–µ—Ä –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∞ (EDN)

```edn
{:intent :safe-free
 :entities [:ptr]
 :must-set-null true
 :description "–ü–æ—Å–ª–µ free() —É–∫–∞–∑–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL"}
```

## üìã –ü—Ä–æ—Ç–æ–∫–æ–ª –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (Garden-Tagging)

–ö–∞–∂–¥—ã–π –±–ª–æ–∫ –∫–æ–¥–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å Intent, **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–º–µ—á–µ–Ω:

```c
// [[garden:intent(INTENT_ID)]]
void implementation_starts_here() {
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
}
// [[/garden:intent]]
```

### –ü—Ä–∞–≤–∏–ª–∞ –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

| –ü—Ä–∞–≤–∏–ª–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **No Orphans** | –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–∑–º–µ—â–∞–π—Ç–µ —Ç–µ–≥ –±–µ–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ |
| **Exact ID** | `INTENT_ID` –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–ª—é—á–æ–º –≤ `.edn` —Ñ–∞–π–ª–µ |
| **Scope** | –¢–µ–≥–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –ª–æ–≥–∏—á–µ—Å–∫—É—é –µ–¥–∏–Ω–∏—Ü—É |
| **Vacuum Rule** | –ö–æ–¥ –≤–Ω–µ `[[garden:intent]]` —Å—á–∏—Ç–∞–µ—Ç—Å—è –º—ë—Ä—Ç–≤—ã–º –∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è |

## üìú –ú–∞–Ω–∏—Ñ–µ—Å—Ç (–ö—Ä–∞—Ç–∫–æ)

1. **–ö–æ–¥ –æ–±–µ—Å—Ü–µ–Ω–∏–ª—Å—è, –°–º—ã—Å–ª –ø–æ–¥–æ—Ä–æ–∂–∞–ª** ‚Äî —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤ –Ω–∞–º–µ—Ä–µ–Ω–∏—è—Ö, –∞ –Ω–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö
2. **–ò–ò ‚Äî –ì–∞–∑, –§–æ—Ä–º–∞–ª—å–Ω–∞—è –õ–æ–≥–∏–∫–∞ ‚Äî –¢–æ—Ä–º–æ–∑–∞** ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–¥–∑–æ—Ä –Ω–∞–¥ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º
3. **Lisp ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π —è–∑—ã–∫ –ö–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤** ‚Äî –≥–æ–º–æ–∏–∫–æ–Ω–Ω–æ—Å—Ç—å –¥–ª—è ¬´–ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã¬ª
4. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –ö–ª–µ—Ç–∫–∞** ‚Äî –ò–ò –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–Ω—É—Ç—Ä–∏ DSL-–∫–ª–µ—Ç–∫–∏ –ø—Ä–∞–≤–∏–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ –ù–∞–¥–µ–π—Å—è-–∏-–ñ–¥–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —ç—Ç–∞–ø–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –Ω–µ –ø–æ—Å–ª–µ
6. **Zero-Cost Security** ‚Äî –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
7. **–°–º–µ—Ä—Ç—å ¬´–ß–µ—Ä–Ω–æ–≥–æ –Ø—â–∏–∫–∞¬ª** ‚Äî –ò–ò –∫–∞–∫ —á—ë—Ä–Ω—ã–π —è—â–∏–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –±–µ–ª–æ–º —è—â–∏–∫–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| [–ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –ò–ò-–∞–≥–µ–Ω—Ç–æ–≤](spec/agent_contract.md) | –ü—Ä–∞–≤–∏–ª–∞ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| [EDN –†–µ–µ—Å—Ç—Ä](registry/index.md) | –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Intent-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ |
